login: yc-user
passphrase: JlOv3bJ-5z
ip: 158.160.69.126
1. Подключение к удаленному серверу:
ssh -i D:/Dev/15_Sprint_DevOps/vm_access/yc-beluza yc-user@158.160.69.126
ssh -i /wind/Dev/15_Sprint_DevOps/vm_access/yc-beluza yc-user@158.160.69.126

scp -i /wind/Dev/15_Sprint_DevOps/vm_access/yc-beluza docker-compose.production.yml \
    yc-user@158.160.69.126:/home/yc-user/foodgram/docker-compose.production.yml 

scp -i /wind/Dev/15_Sprint_DevOps/vm_access/yc-beluza .env \
    yc-user@158.160.69.126:/home/yc-user/foodgram/.env


запуск сервера разраотки фронтэнд
npm run start 

создание образов бэкэнда и фронтэнда из Dockerfile в текущей директории
sudo docker build -t foodgram_backend . 
sudo docker build -t foodgram_frontend -f Dockerfile.production .


проверить, что образ создался
sudo docker image ls

запуск контейнера из образа
sudo docker run --name foodgram_backend_container --rm -p 8000:8000 foodgram_backend
запуск с volume:
sudo docker run --name foodgram_backend_container -p 8000:8000 -v sqlite_data:/data foodgram_backend
sudo docker run --rm -it -p 8000:8000 --name foodgram_frontend_test foodgram_frontend
!Qaz2wsx3edc

sudo docker run --rm -it -p 8000:8000 --name foodgram_frontend_test foodgram_frontend_source

запуск терминала внутри контейнера
sudo docker exec -it foodgram_backend_container bash

миграции внутри запущенного контейнера
sudo docker exec -it foodgram-project-react-backend-1 python manage.py migrate
sudo docker  exec  -it foodgram-project-react-backend-1 python manage.py loaddata recipe_tags.json
sudo docker  exec  -it foodgram-project-react-backend-1 python manage.py loaddata recipe_ingredients.json

остановка контейнера
sudo docker container stop foodgram_backend_container
sudo docker container stop foodgram_frontend_test

убрать все лишние объекты:
sudo docker system prune -af
По этой команде будут удалены все контейнеры и другие связанные сущности докера — например, сети. 
sudo docker compose down
Чтобы удалить и контейнеры, и volumes — выполните команду
sudo docker compose down -v
sudo docker compose -f docker-compose.production.yml down -v


загрузка данных по ингридиентам
python manage.py csv_import --path /wind/Dev/foodgram-project-react/data

создание юзеров с помощью manage-команды
python manage.py create_users

сохранение данных по тегам
python manage.py dumpdata recipe.tags -o recipe_tags.json 
загрузка данных по тегам
python manage.py loaddata recipe_tags.json

sudo docker compose -f docker-compose.production.yml exec backend python manage.py loaddata recipe_tags.json
sudo docker compose -f docker-compose.production.yml exec backend python manage.py loaddata recipe_ingredients.json

sudo docker compose -f docker-compose.yml exec backend python manage.py loaddata recipe_tags.json
sudo docker compose -f docker-compose.yml exec backend python manage.py loaddata recipe_ingredients.json


сохранение данных по ингридиентам
python manage.py dumpdata recipe.ingredients -o recipe_ingredients.json
загрузка данных по dumpdata
python manage.py loaddata recipe_ingredients.json


хорошая статья про разные сериализаторы для request и response
https://stribny.name/blog/drf-different-request-response-serializers/

настройка админки для тегов
https://ctrlzblog.com/how-to-add-tags-to-your-blog-a-django-manytomanyfield-example/

Создание суперюзера, находясь в терминале сервера:
sudo docker compose -f docker-compose.production.yml exec -it backend python manage.py createsuperuser
Создание суперюзера одной командой ()
sudo docker compose exec -it  backend python manage.py createsuperuser --username admin  --email admin@mail.ru --first_name admin --last_name admin
sudo docker compose exec -it  backend python manage.py createsuperuser --username admin  --email admin@mail.ru --first_name admin --last_name admin --noinput

Пример картинки в Base64:
data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAEa0lEQVR4nLzW+1NUZRgH8EUWYbi0aXKRXG5SsDkhJYQsJMNwCaMLMFZcJJKLGSiTCigpZimDSHExbzUgAxKsyHVJDSQdELcFhxUQBAF1XW46KjAFaSrS9+v/0OGHz8u8u3vO85z3fZ73iBNUC0UikW+QHXTuWQujZH7QfFoOPVZdhFL3Yhi5DYhyv6qGe2zPw6s/cl7SGgGDQ3Qw41sF1E99DGVpMXCB6H/+01NkNWDYvOksvLG3ERq5pDMbTTOcX3YEDviGQe+6IfiZnxG0mhyF5/+yhG+azMC99R6w0KEcnrL2hfGOSwTJQO7thOFeqiOMKXgOVxv/CTXPB2FK30GYL9nESNeXwiKzaHjsXAVsjwiHOW/4wLC0ODidcAHWFC16MT8pRAbirFvuGLz+YXTbFjCiAvWvUH1nN/QO5Aq1pz2AHZ4vw7q2S1DaEA8jQkvgkEEttFw4AeWNfO43d+2Hq1LmBMnApSUSQ39JIu8m4R5weMpnl2w5ALVj7/HT/JOwYYc5lGXqQYPsTrhrhDtqXrIaxkpv8xnEZfIKP93hN4uLhMhAz9TyRVyu/fBo7SzMiwmAwYWMzjM2FmbHOsBSKXd3ZV4CPHuBv1LtvAVXiLgGnfav83qnp4FhHLtAplmOEBmIf5FxP4ybBcEnzi7wzNp22P0pa1ux0gbqK7dD+0+Ow9GjG2B8CtfJ8eAOZlnACn93XxecKOMem+jl+vlrRUJkoNe8nPf84nY9dC1vhREruQeWbFbDvhl2mPKdbTDHjfPPdFthx9es1d4oN1j4B/f7/DF+p6PXGHoM8/+sEg9BMgjKOITBq5R14DUcCt3OnYbjry2G2d/bwrb4u9B8ln1GJmMd+Ix9B8Ob/BmjDXMy0bGGU8r+hgpjE2hYFi9EBuL7bazJhOXsoLkB/3JuvxYou9bBZB+ecSGJL8FJL8ZbfJ39ass6ezjmeAIGBD+DulzWzWwFq8F2jqeelY+pEBno3bc7heFB4hp40uJz6HqA55pdsBk0DWGXD+4vhMNr2HeDKrkeMh332wf57EIjzfxUac2coht5ukx6fww7fxgUJAPjEMYr72mCK95nz0nyv8xYovvgxUtX4IkveTJLVcymquoV5vo260BsNAVVFirorG8Ia65ZQPU3vGbBEY0gGWh9eVrJLvMJtsjZ9xWN7C2pMSNw3xy7UPjSJCiZZ01Y+C2Fo1GBsDaQvXPMi7FnVhyGZlV7YNdHfM9wl9kLkYE4ScLuf2OGsau3KuFx/RbY/Sq7/GM112ZDDdcgfYARVTxll88w4MlhmXeP8z3L4NzP7D9177CnWTixv3VLnQTJ4JFcgmFqkQFcXMe3o0ENu/mZVitobs56nirn/ukdOgC3X+GpG9fPk6DhEDOovsvqrU7n+0fYlqvQOZmvsU02NwXJoLOKd5sOZVzjvz2BxR/ytJoarITWD7nfh5pZGesfMb+Nh7Xw2ltcrd1K9rG0iutwNPIhrWX1/r4xH9ZrPIXI4L8AAAD//+UXfD/LJouXAAAAAElFTkSuQmCC

сохранение фикстур
python manage.py dumpdata --exclude contenttypes auth.permission -o db.json

загрузка данных из фикстур
python manage.py loaddata db.json

статья, по которой делались view-функции для единичных ингридиентов
https://testdriven.io/blog/drf-views-part-2/
, где описано создание системы избранного для разных моделей (статьи и комментарии)
https://www.evileg.com/en/post/244/
Универсальная модель для избранного:
https://habr.com/ru/articles/723300/

http://127.0.0.1:8000/api/recipes/
load_shopping_cart/
статья с аналогичной проблемой со списком покупок:
https://stackoverflow.com/questions/68201269/get-amount-of-all-used-ingredients-in-ordered-dishes-django-orm-to-make-a-shop

http://localhost/api/recipes/?limit=6&page=2&tags=breakfast&tags=lunch&tags=dinner"

ссылка для проверки моих подписок:
http://localhost/api/users/subscriptions/?limit=1&page=1&recipes_limit=2

статья по фильтрации полей, которых нет в модели напрямую:
https://stackoverflow.com/questions/74477101/django-rest-filter-by-serializermethodfield-with-custom-filter

замена django filtr'a:
https://stackoverflow.com/questions/66769946/django-rest-framework-filter-a-calculated-serializermethodfield-in-viewset-usi
